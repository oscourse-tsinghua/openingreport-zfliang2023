---
参加人: wjb、zfl
时间: 2024.06.01
主题: 关于在 TAIC 实现细节的讨论
---

### 为什么要使用阻塞队列

这里最初的考虑是可能存在多个任务同时等待 I/O 请求，因此实现为 FIFO，阻塞队列

但是实际在使用时，难以保证多个任务与 I/O 请求完成的顺序关系，最后在实际的使用中，阻塞队列中只有一个任务（每个中断源一个阻塞任务），即中断处理任务。

这里的 FIFO 存放的并不是由 FPGA 从设备的状态以及参数寄存器中读出这一次 I/O 请求对应的信息。

### 需要对外设进行改造吗

这里的改造指的是，在产生中断后，需要 FPGA 写设备的中断状态寄存器，清除掉中断等信息，并从设备中读取出参数。

在 TAIC 的实现中，并不需要对外设进行改造。

吴老师认为 TAIC 的做法本质上还是轮询，真正异步的做法是需要 FPGA 清除中断，读出这次中断对应的参数，并将参数放到 FIFO 中，CPU 从 FIFO 中读出中断的信息。

我认为吴老师的做法本质上是针对单个外设的中断处理实现的特定协处理器，协处理器与 CPU 之间的关系是并行的。这里也需要存在一个任务需要从协处理器的 FIFO 中读出数据，这个任务执行的时机也无法脱离现有的机制，要么一直执行，要么是通过中断来唤醒。

并且这种协处理器实现需要单独针对外设进行改造，缺乏通用性。

也可以不叫其为协处理器，智能设备这个称呼也合适。

总结：我认为 TAIC 的做法具有更强的灵活性，并且从控制器的就绪队列中取出任务这个行为就是任务调度的行为，在任何的操作系统中都脱离不了任务调度，如果这种行为都不算异步，那么没有操作系统是异步的。