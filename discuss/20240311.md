---
参加人: xy、zfl、ldh、lx
时间: 2024.03.11
主题: 关于设计方案中存在的问题讨论
---

### 20240311 讨论

1. 调度器和IPC的[接口描述](https://ats-intc.github.io/docs/ats-intc/02interface/)中都有一个rmembuf，这个接口如何用？
    * 进程状态表：在进程创建时加到硬件中；用缓存的方式来解决硬件资源不足的问题，不在线的进程、线程或协程的响应由它的上级来处理，目前没有使用。
    * 不在硬件中的进程状态，通过进程状态表首地址查内存中的对应项来进行处理，即加载到硬件上，进行处理；
2. IPC中的接收方注册中，要指定发方吗？
    * 在田的实现中是由发方维护收方列表的；
    * 目前在赵的实现中没有关于通信边的控制是不支持的；后续需要补上。
3. 收发方的ID格式？
    * 目前没有考虑，需要按田的实现进行补充；大致的原理是，层次性的命名；
4. 外部设备阻塞队列的操作是干什么用的？
    * 中断服务例程的行为；
5. [地址空间描述](https://ats-intc.github.io/docs/ats-intc/01register-space/)中，没有明白各部分的关系。4092个进程？每个进程中有一个优先级队列？外部中断描述描述符表对应等待外设的阻塞状态协程列表？
    * 可以统一成每个进程占一页；支持共4096个进程；
6. [行为描述](https://ats-intc.github.io/docs/ats-intc/03inner-struct-behavior/)中等待队列有两个，外设等待队列和什么？每个进程有一个IPC区域和一个调度区域？
    * 外设、IPC（软件和控制器）
    * 调度区域：对应协程的就绪队列；IPC区域：对应协程的等待协程；
    * 目前占的地址空间太大；建议统一成每个进程相同的虚拟地址；
7. [控制器行为状态图](https://ats-intc.github.io/docs/ats-intc/03inner-struct-behavior/)中的操作分类：系统有三个队列，外设等待队列（控制器维护）、就绪协程队列（控制器维护）、控制器维护的IPC等待队列（控制器维护，可视为“软件维护的IPC等待队列”的缓存）、软件维护的IPC等待队列（软件维护）、
    * 占用CPU运行：最高优先级就绪协程从就绪协程出队，进入运行状态；
    * 运行协程等待外设：进入外设等待队列；
    * 收到外设中断：协程协程从外设等待队列出队，进入就绪协程队列；
    * 收方注册IPC：IPC处理协程进入IPC等待队列；
    * 发方发送IPC：从软件或控制器维护的IPC等待队列出队，进入就绪协程队列；
    * 建议：以协程状态为顶点，组织行为状态图；什么时候会进入OS维护的IPC等待队列？
    * 就绪协程队列的入队：分两种情况，由控制器执行的从外设等待队列到就绪队列，由软件执行的从软件维护等待队列到就绪队列；
    * 协程的感知：编译器、OS、硬件（控制器，理想情况下应该是CPU的状态）
8. 进程状态表：由控制器维护？应该可以做成软件维护，控制器保存一个缓存的副本。对吗？
    * 目前的实现是，进程状态表一直在硬件中；
9. IPC处理的时序图（系统调用的执行过程和IPC执行过程）中序号7对应有两个操作。需要确认一下。（这个时序图很不错）
    * 笔误
10. 没有看到讨论就绪协程的全局位图的描述。应该有一个吧？
    * 目前没有考虑；需要有一个；好像不需要在进程间进行这些信息的隔离；

### 总结

1. 缓存
2. 收发能力
3. 状态图
4. 地址空间：外部中断处理；
5. 全局位图